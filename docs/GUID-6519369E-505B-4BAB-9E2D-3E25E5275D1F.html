<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="DC.type" content="topic" />
<meta name="DC.title" content="audio_player_basic" />
<meta name="DC.relation" scheme="URI" content="GUID-408D6777-0172-406B-8442-B97FD5287AC8.html" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="audio-player-basic" />
<link rel="stylesheet" type="text/css" href="stylesheets/commonltr.css" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<link rel="stylesheet" type="text/css" href="./stylesheets/common-extended.css" /><title>audio_player_basic</title>
<meta name="Microsoft.Help.Id" content="GUID-32F3914E-5B2E-4D3C-898B-3A4760B287C7-audio-player-basic" />
<meta name="Microsoft.Help.TocParent" content="GUID-32F3914E-5B2E-4D3C-898B-3A4760B287C7" />
<meta name="Microsoft.Help.TocOrder" content="0" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="MPLABÂ® Harmony Audio Apps Help Reference A 04/2022" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
        function cpy(id, button) {
        
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                    button.textContent = "Copy";
                    button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
              console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
        }
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?GUID-6519369E-505B-4BAB-9E2D-3E25E5275D1F"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style></head>
<body id="audio-player-basic">
<h1 class="title topictitle1" id="ariaid-title1">audio_player_basic</h1><div class="body"><p class="p">This topic provides instructions and information about the MPLAB Harmony 3 Audio Player Basic demonstration application, which is included in the MPLAB Harmony Library distribution.</p>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="GUID-408D6777-0172-406B-8442-B97FD5287AC8.html">Harmony 3 audio application examples</a></div>
</div>
</div><div class="topic nested1" aria-labelledby="ariaid-title2" id="description"><h2 class="title topictitle2" id="ariaid-title2">Description</h2><div class="body"><p class="p">The audio player (audio_player_basic) application configures the development board to use a microSD card or be in USB Host Mass Storage Device (MSD) mode. The application supports the FAT file system. When a mass storage device is connected to the development board via its Target USB port, the device is mounted, and the application begins to scan for files starting at the root directory. It will search for .wav files up to 10 directory levels deep. A list of files found, and their paths, will be created and stored.</p>
<p class="p">Once the scan is complete, the first track in the list will be opened, validated and played. The application will read the .wav file header to validate. Configuration of the number of channels, sample size, and sample rate stated in the file will be handled by the application for proper playback. If a file that can't be played is found, it will be skipped, and the next sequential file will be tried. If the file can be played, it will then go on and read the .wav file data and write it to the codec for playback.</p>
<p class="p">Command and control of the codec is done through an I2C driver. Data to the codec driver is sent through SSC via I2S Driver and the output will be audible through the headphone output jack of the WM8904 Audio Codec Module connected to the SAM E70 Xplained Ultra board.</p>
<p class="p">Supported audio files are as represented in the table below.</p>
</div>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title3" id="supported-format"><h2 class="title topictitle2" id="ariaid-title3">Supported Format</h2><div class="body">
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:middle;" id="d16909e42"><span><strong class="ph b">Audio Format</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d16909e45"><span><strong class="ph b">Sample Rate (kHz)</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d16909e48"><span><strong class="ph b">Description</strong></span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e42 "><span>PCM</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e45 "><span>8 to 96</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e48 "><span>PCM (Pulse Code Modulation) is an uncompressed format. The digital data is a direct representation of the analog audio waveform. The container for the data will be a WAVE file (.wav) format. It is the native file format used by Microsoft Windows for storing digital audio data.</span></td>
</tr>
</tbody>
</table>
</div>
<p class="p">The defines DISK_MAX_DIRS and DISK_MAX_FILES in the app.h file, determines the maximum number of directories that should be scanned at each level of the directory tree (to prevent stack overflow, the traversing level is limited to 10), and the maximum number of songs in total the demonstration should scan (currently set to 4000 because of memory limitations).</p>
</div>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title4" id="architecture"><h2 class="title topictitle2" id="ariaid-title4">Architecture</h2><div class="body"><p class="p">The application runs on the SAM E70 Xplained Ultra Board, which contains a ATSAME70Q21B microcontroller with 2 MB of Flash memory and 384 KB of RAM running at 300 MHz using the following features:</p>
<ul class="ul"><li class="li"><p class="p">One push button (SW1)</p>
</li>
<li class="li"><p class="p">Two LEDs (amber LED1 and green LED2)</p>
</li>
<li class="li"><p class="p">WM8904 Codec Daughter Board mounted on a X32 socket</p>
</li>
</ul>
<p class="p">The SAM E70 Xplained Ultra board does not include the WM8904 Audio Codec daughterboard, which is sold separately on microchipDIRECT as part number AC328904.</p>
<p class="p">The application currently only supports WAVE (.wav) format files and ADPCM (.pcm) files.</p>
<p class="p">The audio_player_basic application uses the MPLAB Harmony Configurator to setup the USB MSD Host, file system, codec, and other items in order to read the music files on a USB mass storage device and play it back through the WM8904 Codec Module. It scans WAV (PCM) format files from a mounted FAT drive and streams audio through a WM8904 Audio Codec to a pair of headphones. In the application, the number of audio output buffers can always be set to more than two to enhance the audio quality. The size of input buffer in this application is chosen to be able to handle the data supported.</p>
<p class="p">The following figure shows the architecture for the demonstration (USB Host version shown):</p>
</div>
<div class="topic nested2" aria-labelledby="ariaid-title5" id="architecture-block-diagram"><h3 class="title topictitle3" id="ariaid-title5">Architecture Block Diagram</h3><div class="body"><br /><img class="image" src="GUID-28414F6B-6A39-4B56-878D-9BD0C11B2207-low.png" /><br /></div>
</div>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title6" id="demonstration-features"><h2 class="title topictitle2" id="ariaid-title6">Demonstration Features</h2><div class="body"><ul class="ul"><li class="li"><p class="p">USB MSD Host Client Driver (see USB MSD Host Client Driver Library)</p>
</li>
<li class="li"><p class="p">microSD card</p>
</li>
<li class="li"><p class="p">FAT File System (see File System Service Library)</p>
</li>
<li class="li"><p class="p">Audio real-time buffer handling</p>
</li>
<li class="li"><p class="p">WM8904 Codec Driver (see Audio Codec Driver Libraries)</p>
</li>
<li class="li"><p class="p">I<sup class="ph sup">2</sup>S usage in audio system (see I2S Driver Library)</p>
</li>
<li class="li"><p class="p">DMA (see DMA Peripheral Library)</p>
</li>
<li class="li"><p class="p">Timer (see Timer Peripheral Library)</p>
</li>
<li class="li"><p class="p">GPIO Control (see Port Peripheral Library)</p>
</li>
</ul>
</div>
<div class="topic nested2" aria-labelledby="ariaid-title7" id="harmony-configuration"><h3 class="title topictitle3" id="ariaid-title7">Harmony Configuration</h3><div class="body"><ol class="ol"><li class="li"><span class="indent-level-default">1.</span><p class="p">Add BSP-&gt;SAM E70 Xplained Ultra BSP</p>
</li>
<li class="li"><span class="indent-level-default">2.</span><p class="p">Add Audio-&gt;Templates-&gt;WM8904 Codec
a.  Yes to all popups.</p>
</li>
<li class="li"><span class="indent-level-default">3.</span><p class="p">Add Libraries-&gt;USB-&gt;Host Stack-&gt;MSD Client Driver
a.  Yes to all popups.</p>
</li>
<li class="li"><span class="indent-level-default">4.</span><p class="p">Add Harmony-&gt;System Services-&gt;FILE SYSTEM</p>
</li>
<li class="li"><span class="indent-level-default">5.</span><p class="p">Remove FreeRTOS if Bare Metal or Graphics versions.</p>
</li>
<li class="li"><span class="indent-level-default">6.</span><p class="p">Add Harmony-&gt;Audio-&gt;Decoder-&gt;Audio Decoder Libraries</p>
</li>
<li class="li"><span class="indent-level-default">7.</span><p class="p">Connect MSD Client Driver: DRV_MEDIA to FILE SYSTEM: DRV_MEDIA</p>
</li>
<li class="li"><span class="indent-level-default">8.</span><p class="p">Connect WM8904 Driver:DRV_I2S to I2S Driver:DRV_I2S</p>
</li>
</ol>
<p class="p">After reorganization, your graph would look similar to one of the following project graphs. They specify the drivers, services, and libraries being brought into the project to further extend the applications abilities.</p>
<br /><img class="image" src="GUID-3D41EFC3-FE6F-456C-8042-AB276E462926-low.png" /><br /><p class="p">Fig 2 (Project graph of the default E70 bare metal configuration using the SSC)</p>
<br /><img class="image" src="GUID-9C793454-03FD-4A38-BB7F-069195EECFF3-low.png" /><br /><p class="p">Fig 3 (Project graph of the E70 FreeRTOS configuration using the SSC)</p>
<br /><img class="image" src="GUID-34BA22D1-2BD7-4EB2-B2FB-867B84AE57EE-low.png" /><br /><p class="p">Fig 4 (Project graph of the E54 bare metal configuration using the I2S)</p>
<br /><img class="image" src="GUID-D46FC248-874F-4A4F-B406-463663F56091-low.png" /><br /><p class="p">Fig 5 (Project graph of the E54 FreeRTOS configuration using the I2S)</p>
</div>
</div>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title8" id="tools-setup-differences"><h2 class="title topictitle2" id="ariaid-title8">Tools Setup Differences</h2><div class="body"><p class="p">The default configuration should be correct for the majority of the application. The following configurations will need to be changed in order for proper operations.</p>
<p class="p">For projects using the E54 Curiosity Ultra, the I2S interface and the WM8904 as a Slave (the E54 generates the I2S clocks):</p>
<p class="p">In the MPLAB Harmony Configurator: <em class="ph i">Tools&gt;Clock</em> <em class="ph i">Configuration</em> dialog:</p>
<ul class="ul"><li class="li"><p class="p">Set enable the Crystal Oscillator, change it frequency to 12,000,000 Hz, and select CRYSTAL.</p>
</li>
<li class="li"><p class="p">Uncheck the Fractional Digital Phase Locked Loop enable (FDPLL 0).</p>
</li>
<li class="li"><p class="p">In the CLK Generator 0 box, change the input to DFLL for an output of 48 MHz.</p>
</li>
<li class="li"><p class="p">In the CLK Generator 1 box, change the input to XOSC0 with a divider of 1 for an output of 12 MHz.</p>
</li>
<li class="li"><p class="p">In the GCLK Generator, uncheck the selection for GCLK 2, and then select the GCLK 3 tab. Choose the DFLL as the input, with a divide by 4 for an output of 12 MHz. You should end up with a clock diagram like this:</p>
</li>
</ul>
<br /><img class="image" src="GUID-4F4A7E44-3C48-451E-BCCC-2DDE0FC98DE2-low.png" /><br /><p class="p">For projects using the E70 Xplained Ultra, the SSC interface and the WM8904 as a Master (the WM8904 codec generates the I2S clocks):</p>
<p class="p">In the MPLAB Harmony Configurator: <em class="ph i">Tools&gt;Clock</em> <em class="ph i">Configuration</em> dialog:</p>
<p class="p">Uncheck the Main RC Oscillator and check the "Bypass" for the Main Crystal Oscillator. When the Bypass is checked, it will cause the Main Crystal Oscillator to become unchecked.</p>
<br /><img class="image" src="GUID-F9947C12-9759-4567-8420-246D5827E451-low.png" /><br /><p class="p">Enable the PCK2 output to enable the WM8904 master clock:</p>
<br /><img class="image" src="GUID-BDE2C74E-85B4-4FE2-BD4B-F6B20DEBEC70-low.png" /><br /><p class="p"><em class="ph i">Clock Diagram&gt;Peripheral Clock Enable</em> Enable clocking for the SSC.</p>
<br /><img class="image" src="GUID-D6839960-E0D2-4F97-8CD8-8C9862F17136-low.png" /><br /><p class="p">In the MPLAB Harmony Configurator: <em class="ph i">File System</em> dialog_:_</p>
<p class="p">The Auto Mount feature must be selected in order to expose the media type selection. The media type that is being used in this application is Mass Storage Device. This must be correctly configured, or the storage device will not mount.</p>
<br /><img class="image" src="GUID-DDB5159E-23F2-43BF-AF00-BEA02A86D76B-low.png" /><br /><p class="p">In the MPLAB Harmony Configurator: <em class="ph i">System</em> dialog:</p>
<p class="p">Set the heap size in Harmony if it is not already set for the linker. Certain projects may set the heap to a larger size automatically.</p>
<br /><img class="image" src="GUID-F2941498-3E44-47D8-B7E0-F60B9CF3194F-low.png" /><br /></div>
<div class="topic nested2" aria-labelledby="ariaid-title9" id="building-the-application"><h3 class="title topictitle3" id="ariaid-title9">Building the Application</h3><div class="body"><p class="p">This section identifies the MPLAB X IDE project name and location and lists and describes the available configurations for the demonstration.</p>
<p class="p"><strong class="ph b">Description</strong></p>
<p class="p">The parent folder for these files is audio/apps/audio_player_basic. To build this project, you must open the audio/apps/audio_player_basic/firmware/*.X project file in MPLAB X IDE that corresponds to your hardware configuration.</p>
</div>
</div>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title10" id="mplab-x-ide-project-configurations"><h2 class="title topictitle2" id="ariaid-title10">MPLAB X IDE Project Configurations</h2><div class="body"><p class="p">The following table lists and describes supported project configurations.</p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:middle;" id="d16909e263"><span><strong class="ph b">Project Name</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d16909e266"><span><strong class="ph b">BSP Used</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d16909e269"><span><strong class="ph b">Description</strong></span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e263 "><span>apb_sam_e54_ult_wm8904_i2s_sdmmc</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e266 "><span>sam_e54_cult</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e269 "><span>This demonstration runs on the ATSAME54P20A processor on the SAM E54 Curiosity Ultra board with the WM8904 Audio Codec Daughter Board. The WM8904 codec is configured as the master, and the I2S peripheral as the slave. The project config is for reading data from a microSD card. The data is sent to the headphone output of the codec daughter card via I2S driver.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e263 "><span>apb_sam_e54_ult_wm8904_i2s_sdmmc_freertos</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e266 "><span>sam_e54_cult</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e269 "><span>This demonstration runs on the ATSAME54P20A processor on the SAM E54 Curiosity Ultra board with the WM8904 Audio Codec Daughter Board. The WM8904 codec is configured as the master, and the I2S peripheral as the slave. The project config is for reading data from a microSD card. The data is sent to the headphone output of the codec daughter card via I2S driver. This demonstration uses FreeRTOS to schedule running tasks.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e263 "><span>apb_sam_e70_xult_wm8904_ssc</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e266 "><span>sam_e70_xult</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e269 "><span>This demonstration runs on the ATSAME70Q21B processor on the SAM E70 Xplained Ultra board with the WM8904 Audio Codec Daughter Board. The WM8904 codec is configured as the master, and the SSC peripheral as the slave. The project configuration is for reading data from a file on a USB Mass Storage Device. The data is sent to the headphone output of the codec daughter card via I2S protocol using the SSC PLib.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e263 "><span>apb_sam_e70_xult_wm8904_ssc_freertos</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e266 "><span>sam_e70_xult</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e269 "><span>This demonstration runs on the ATSAME70Q21B processor on the SAM E70 Xplained Ultra board with the WM8904 Audio Codec Daughter Board. The WM8904 codec is configured as the master, and the SSC peripheral as the slave. The project configuration is for reading data from a file on a USB Mass Storage Device. The data is sent to the headphone output of the codec daughter card via I2S protocol using the SSC PLib. This demonstration uses FreeRTOS to schedule tasks to run.</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="topic nested2" aria-labelledby="ariaid-title11" id="configuring-the-hardware"><h3 class="title topictitle3" id="ariaid-title11">Configuring the Hardware</h3><div class="body"><p class="p">This section describes how to configure the supported hardware.</p>
<p class="p"><strong class="ph b">Description</strong></p>
<p class="p">Using the SAM E54 Curiosity Ultra board and the WM8904 Audio Codec Daughter Board, using the I2S PLIB:</p>
<p class="p">To connect to the I2S, the jumpers (J6, J7, J8, and J9) on the WM8904 Codec Daughterboard must be oriented away from the pink, mic in, connector. See the red outlined jumpers in the below image as reference.</p>
<br /><img class="image" src="GUID-AC5CB96F-2EEC-48DD-B3F9-443543BAC4A3-low.png" /><br /><p class="p">In addition, make sure the J401 jumper (CLK SELECT) is set for the PA17 pin:</p>
<br /><img class="image" src="GUID-27715216-D3C8-438A-B404-8F9217C84A27-low.png" /><br /><p class="p"><img class="image" src="GUID-AE3D4889-C877-429D-93EA-556A81DE281D-low.png" /><br /> <strong class="ph b">Note:</strong> The SAM E54 Curiosity Ultra board does not include the WM8904 Audio Codec daughterboard, which is sold separately on microchipDIRECT as part number AC328904.</p>
<p class="p">Using the SAM E70 Xplained Ultra board and the WM8904 Audio Codec Daughter Board, using the SSC PLIB:</p>
<p class="p">Jumper J203, which is next to the SAM E70 Xplained Ultra logo, should be jumpered for LED2.</p>
<p class="p">To connect to the SSC, the jumpers (J6, J7, J8, and J9) on the WM8904 Codec Daughterboard must be oriented away from the pink, mic in, connector. See the red outlined jumpers in the below image as reference.</p>
<br /><img class="image" src="GUID-AC5CB96F-2EEC-48DD-B3F9-443543BAC4A3-low.png" /><br /><p class="p"><img class="image" src="GUID-AE3D4889-C877-429D-93EA-556A81DE281D-low.png" /><br /> <strong class="ph b">Note:</strong> The SAM E70 Xplained Ultra board does not include the WM8904 Audio Codec daughterboard, which is sold separately on microchipDIRECT as part number AC328904.</p>
</div>
</div>
<div class="topic nested2" aria-labelledby="ariaid-title12" id="running-the-demonstration"><h3 class="title topictitle3" id="ariaid-title12">Running the Demonstration</h3><div class="body"><p class="p">This section demonstrates how to run the demonstration.</p>
<p class="p"><strong class="ph b">Description</strong></p>
<p class="p"><img class="image" src="GUID-CC35FC64-32DC-4149-A920-4BEB367B9CF1-low.png" /><br />  <strong class="ph b">Important!</strong> Prior to using this demonstration, it is recommended to review the MPLAB Harmony 3 Release Notes for any known issues.</p>
<p class="p">Compile and program the target device. While compiling, select the appropriate MPLAB X IDE project based. Refer to Building the Application for details.</p>
<ol class="ol"><li class="li"><span class="indent-level-default">1.</span><p class="p">Connect headphones to the HP OUT jack of the WM8904 Audio Codec Daughter Board (see <strong class="ph b">Figure 2 below</strong>).</p>
</li>
<li class="li"><span class="indent-level-default">2.</span><p class="p">Connect power to the board. The system will be in a wait state for USB to be connected (amber LED1 blinking).</p>
</li>
<li class="li"><span class="indent-level-default">3.</span><p class="p">For the E54 board:</p>
</li>
</ol>
<p class="p">Insert a micro SD card into the slot on the bottom side of the board as shown in Figure 1. The contacts of the micro SD card should be facing the bottom side of the board.</p>
<br /><img class="image" src="GUID-85DD8E9E-4C4A-4D98-A9B7-82DB40B0EB45-low.png" /><br /></div>
<div class="topic nested3" aria-labelledby="ariaid-title13" id="figure-1-sd-card-slot-on-bottom-of-sam-e54-curiosity-ultra-board"><h4 class="title topictitle4" id="ariaid-title13">Figure 1: SD Card slot on bottom of SAM E54 Curiosity Ultra Board</h4><div class="body"><ol class="ol"><li class="li"><span class="indent-level-default">1.</span><p class="p">For the E70 board:</p>
</li>
</ol>
<p class="p">Connect a USB mass storage device (thumb drive) that contains songs of supported audio format to the USB TARGET connector of the SAM E70 Xplained Ultra board. You will probably need a USB-A Female to Micro-B Male adapter cable to do so. The application currently can only stream WAVE (.wav) format audio files.</p>
<ol class="ol"><li class="li"><span class="indent-level-default">1.</span><p class="p">When the device is connected the system will scan for audio files. Once the scanning is complete and at least one file is found (green LED2 on steady), listen to the audio output on headphones connected to the board. Use Switch SW1 as described under Control Description to change the volume or advance to the next track.</p>
</li>
</ol>
<br /><img class="image" src="GUID-8EE6669B-CBCA-42AB-8D98-25C838A59C0B-low.png" /><br /></div>
</div>
<div class="topic nested3" aria-labelledby="ariaid-title14" id="figure-2-wm8904-audio-codec-daughter-board-on-sam-e70-xplained-ultra-board-control-description"><h4 class="title topictitle4" id="ariaid-title14">Figure 2: WM8904 Audio Codec Daughter Board on SAM E70 Xplained Ultra board Control Description</h4><div class="body"><p class="p">Long presses of the push button cycle between volume control and the linear track change mode.</p>
<p class="p">When in volume control mode, short presses of the push button cycle between Low, Medium, High, and Mute volume outputs. While in the Mute mode, a pause of the playback will also take place.</p>
<p class="p">When in the linear track change mode, short presses of the push button will seek to the end of the currently playing track and willstart the next track that was found in sequence. After all tracks have been played, the first track will start again in the same sequential order.</p>
<p class="p">Button control is shown in the table below.</p>
</div>
</div>
<div class="topic nested3" aria-labelledby="ariaid-title15" id="button-operations"><h4 class="title topictitle4" id="ariaid-title15">Button Operations</h4><div class="body">
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:middle;" id="d16909e408"><span><strong class="ph b">Long Press (&gt; 1 sec)</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d16909e411"><span><strong class="ph b">Short Press (&lt; 1 sec)</strong></span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e408 "><span>Volume Control</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e411 "><span>Low (-66 dB)</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e408 "><span>-</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e411 "><span>Medium (-48 dB)</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e408 "><span>-</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e411 "><span>High (0 dB)</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e408 "><span>-</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e411 "><span>Mute/Pause</span></td>
</tr>
</tbody>
</table>
</div>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:middle;" id="d16909e441"><span> </span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d16909e443"><span> </span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e441 "><span>Linear Track Change</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e443 "><span>Next sequential track</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="topic nested3" aria-labelledby="ariaid-title16" id="status-indicator-description"><h4 class="title topictitle4" id="ariaid-title16">Status Indicator Description</h4><div class="body"><p class="p">When the application first starts running, it looks to find an attached storage device. If one is not found, LED1 will toggle on and off about every 100ms indicating that a storage device is not attached.</p>
<p class="p">When a storage device is attached, LED1 will turn off. At this time, the file system will be scanned for WAVE files with a .wav extension.</p>
<p class="p">If no WAVE files are found on the storage device, LED2 will remain off and scanning of the device will continue.</p>
<p class="p">If any WAVE files are found, LED2 will turn on and playback of the first file found in sequence will start.</p>
<p class="p">LED status indication is shown in the table below.</p>
</div>
</div>
<div class="topic nested3" aria-labelledby="ariaid-title17" id="led-status"><h4 class="title topictitle4" id="ariaid-title17">LED Status</h4><div class="body">
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:middle;" id="d16909e476"><span><strong class="ph b">Operation</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d16909e479"><span><strong class="ph b">LED1 Status (Red)</strong></span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d16909e482"><span><strong class="ph b">LED2 Status (Green)</strong></span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e476 "><span>No Storage Device Connected</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e479 "><span>Toggle 100ms</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e482 "><span>Off</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e476 "><span>Storage Device Connected</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e479 "><span>Off</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e482 "><span>See Files Found Operation</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e476 "><span>Playback: Volume Control</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e479 "><span>Off</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e482 "><span>See Files Found Operation</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e476 "><span>Playback: Volume Mute</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e479 "><span>Toggle 500ms</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e482 "><span>See Files Found Operation</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e476 "><span>Playback: Linear Track Change</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e479 "><span>On</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e482 "><span>See Files Found Operation</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e476 "><span>Files Found (Yes/No)</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e479 "><span>See above operations</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d16909e482 "><span>On/Off</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</body>
</html>